<!-- Header -->
<%- include ('../partials/header') %> <%- include ('../partials/menu') %> <%-
include ('../partials/message') %>
<!-- Body with the two div Container elements  -->
<head>
  <!-- <title>Discover Communities</title> -->
  <link rel="stylesheet" href="resources/css/discover.css" />
</head>
<body>
  <main>
    <div id="Container">
      <div id="CommunityPageContainer">
        <div class="title">Community Page</div>
        <hr />
          <table class="table">
            <thead>
              <tr>
                <!-- <th>Community ID</th> -->
                <th>Community Name</th>
                <th>Community Description</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              <% allCommunities.forEach(community => { %>
              <tr>
                <form method="POST" action="<%- "/addUserToCommunity/" + community.communityid %>">
                  <!-- <td><%= community.communityid %></td> -->
                  <td><%= community.name %></td>
                  <td><%= community.description %></td>
                  <td>
                    <button type="submit">Join</button>
                  </td>
                </form>
              </tr>
              <% }); %>
            </tbody>
          </table>
        
      </div>

      <div id="RandomEventContainer">
        <div class="title">Upcoming Events</div>
        <hr />
          <table class="table">
            <thead>
              <tr>
                <!-- <th>Event ID</th> -->
                <th>Event Name</th>
                <th>Event Description</th>
                <th>Event Date</th>
                <!-- <th>Event Time</th> -->
                <th>Event Location</th>
                <!-- <th>Event Community</th> -->
                <th></th>
              </tr>
            </thead>
            <tbody>
              <% allEvents.forEach(event => { %>
              <tr>
                <form method="POST" action="<%- "/addUserToEvent/" + event.eventid %>">
                  <!-- <td><%= event.eventid %></td> -->
                  <td><%= event.name %></td>
                  <td><%= event.description %></td>
                  <td><%= event.date %></td>
                  <!-- <td><%= event.time %></td> -->
                  <td><%= event.location %></td>
                  <!-- <td><%= event.communityid %></td> -->
                  <td>
                    <div class="popup" onclick="myFunction()">
                      <button type="submit">Join</button>
                      <span class="popuptext" id="myPopup">Event Joined!</span>
                    </div>
                  </td>
                </form>
              </tr>
              <% }); %>
            </tbody>
          </table>
      </div>
    </div>
    <script>
      function myFunction() {
        // const form = element.closest('.event-form');
        // const popup2 = form.querySelector('.popup');
        var popup = document.getElementById("myPopup");
        
        // popup2.classList.toggle('active');
        // // Optionally, you can hide the popup after a delay
        // setTimeout(() => {
        //   popup2.classList.remove('active');
        // }, 2000); // 2000 milliseconds (2 seconds)
        popup.classList.toggle("show");
        setTimeout(() => {
            popup.classList.add("hide");
        }, 600);
        // popup.classList.toggle("show");
        // popup.classList.add("hide");
      }
    </script>
  </main>
</body>

<!-- footer -->
<%- include ('../partials/footer') %>
